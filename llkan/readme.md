# 自动连连看 —— 让你感受连连看不一样的爽玩法
`2019.05.22 by jianfeng`

## 程序说明
> 本自动游戏程序仅用作学习使用，请维护游戏的公平性，禁止作弊使用
### 用到的库
- numpy
- pyautogui
- pillow(py3)
- pywin32

### 程序文件
- auto主脚本
    - [game_auto.py](./game_auto.py)
    > 自动游戏运行脚本
    - [graph_path.py](./graph_path.py)
    > 路径识别算法
    - [image_contrast.py](./image_contrast.py)
    > 图像对比
    - [image_get.py](./image_get.py)
    > 图像获取，分割等
- 辅助脚本
    - [pyautogui_test.py](./pyautogui_test.py)
    > 模块测试 + 坐标获取 + RGB采集
    - [picture_split.py](./picture_split.py)
    > 图像分割

### 相关参数
- 参考image_get.py中的具体参数修改方式

---------------------------------------------
## image contrast 用到的相关算法说明
### 常用对比方式
- 感知哈希算法（常用）
    1. 将图像大小归一化(例如8*8) 
        > 去除大小，纵横比差异
    2. 灰度化处理
        - [原理] $Gray = R \times 0.299 + G \times 0.587 + B \times 0.114$
        - [实际应用1] $Gray=(R*30+G*59+B*11+50)/100$
            > 参数50用于四舍五入
        - [实际应用2] $Gray=(R*76+G*151+B*28)>>8$
            > 移位方式避免除法导致的性能低问题
        - [不常用] $Gray=(R + G + B )/3$
            > 精度比较低，图像转化为灰度效果不是太好
        - [Adobe PS] $Gray = (R^{2.2} \times 0.2973 + G^{2.2} \times 0.6274 + B^{2.2} \times 0.0753)^{\frac{1}{2.2}}$
            > 运行速度偏慢，但是效果好。(^.^)毕竟是PhotoShop啊
    3. 计算平均灰度值avg (为后续平均Hash做准备)
    4. 信息指纹 (计算方式有多种)
        - (遍历8*8=64个像素点，分别和平均灰度值avg进行对比）
        - [1.平均哈希] 大于等于avg 则为1，否则记为0
        - 并按照一定顺序排列称64bit指纹编码
    5. 比较两幅图的指纹编码，计算其相似度
        > 理论上：汉明距离 Hamming distance
        - [信息论] 两个等长字符串之间的汉明距离为两个字符串之间对应位置不同字符的个数
        - 若汉明距离<=5，则认为相似
        - 若汉明距离>10，则认为不同

- 直方图方法
    > [思想] 基于简单的向量相似度来对图像相似度进行度量
    1. 分别计算两幅图的直方图
    2. 归一化
    3. 按照某种距离度量标准进行相似度测量
    - 优点：方便归一化，计算量适中。较适合描述难以自动分割的图像
    - 缺点：仅反映的是灰度的概率分布，没有图像的空间位置。容易误判。
        > 从信息论角度考虑，直方图转换，信息量丢失较大。因此单一通过直方图匹配不够精确

### 问题及解决
- Qllk 相同物体不同颜色的区分
> 采用灰度直方图，分别计算每个通道的相似度，随后3通道求平均值。
